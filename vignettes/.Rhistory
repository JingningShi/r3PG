library(r3PG)
knitr::opts_chunk$set(echo = TRUE)
data("clim.WesternOR")
data("clim.WesternOR")
data("clim.Argentina")
data("clim.BritishColumbia")
data("clim.NorthCarolina")
View(clim.Argentina)
with(clim.WesternOR, plot(Rain ~ c(1:12)))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l"))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = ""))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = F))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb)
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb)
month.abb
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb)
data("clim.WesternOR")
data("clim.Argentina")
data("clim.NorthCarolina")
data("clim.BritishColumbia")
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb)
with(clim.NorthCarolina, )
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, cex=1.2))
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
par(new = T)
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, cex=1.2, type = "l"))
axis(side = 4)
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4); mtext(side = 4, line = 3, "Temperature (c)")
axis(side = 4, col = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)")
axis(side = 4, col = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4, col = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4, col = "darkorange", col.ticks = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4, col = "darkorange", col.lab = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = "Rain (mm)", xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4, col = "darkorange", col.axis = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = NA, xlab = "", xaxt = "n"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue"); mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l"))
axis(side = 4, col = "darkorange", col.axis = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = NA, xlab = "", xaxt = "n", col = "dodgerblue"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue"); mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA, type = "l", col = "darkorange"))
axis(side = 4, col = "darkorange", col.axis = "darkorange"); mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
View(clim.NorthCarolina)
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = NA, xlab = "",
xaxt = "n", col = "dodgerblue", main = "Western Oregon"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue")
mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA,
type = "l", col = "darkorange"))
axis(side = 4, col = "darkorange", col.axis = "darkorange")
mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
with(clim.Argentina, plot(Rain ~ c(1:12), type = "l", ylab = NA,
xlab = "", xaxt = "n", col = "dodgerblue",
main = "North Carolina"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue")
mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.Argentina, plot(Tav ~ c(1:12), pch=16, axes=F,
xlab=NA, ylab=NA, type = "l",
col = "darkorange"))
axis(side = 4, col = "darkorange", col.axis = "darkorange")
mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
par(mfrow = c(1,2))
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", ylab = NA, xlab = "",
xaxt = "n", col = "dodgerblue", main = "Western Oregon"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue")
mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.WesternOR, plot(Tav ~ c(1:12), pch=16, axes=F, xlab=NA, ylab=NA,
type = "l", col = "darkorange"))
axis(side = 4, col = "darkorange", col.axis = "darkorange")
mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
with(clim.BritishColumbia, plot(Rain ~ c(1:12), type = "l", ylab = NA,
xlab = "", xaxt = "n", col = "dodgerblue",
main = "North Carolina"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
axis(side = 2, col = "dodgerblue", col.axis = "dodgerblue")
mtext(side = 2, line = 3, "Rain (mm)", col =  "dodgerblue")
par(new = T)
with(clim.BritishColumbia, plot(Tav ~ c(1:12), pch=16, axes=F,
xlab=NA, ylab=NA, type = "l",
col = "darkorange"))
axis(side = 4, col = "darkorange", col.axis = "darkorange")
mtext(side = 4, line = 3, "Temperature (c)", col =  "darkorange")
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github(repo = "griffithdan/r3PG")
library(r3PG)
data("clim.WesternOR", "clim.Argentina", "clim.NorthCarolina", "clim.BritishColumbia")
par(mfrow = c(1,2), mar = c(5, 4, 1, 2) + 0.1)
with(clim.WesternOR, plot(Tav ~ c(1:12), type = "l", xlab = "", ylim = c(-10,30),
xaxt = "n", col = "dodgerblue", ylab = expression(paste("Mean Temperature (",degree,C,")", sep = ""))))
with(clim.Argentina, lines(y = Tav, x = c(1:12), col = "darkorange"))
with(clim.BritishColumbia, lines(y = Tav, x = c(1:12), col = "darkgreen"))
with(clim.NorthCarolina, lines(y = Tav, x = c(1:12), col = "purple"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(clim.WesternOR, plot(Rain ~ c(1:12), type = "l", xlab = "", ylim = c(0,400),
xaxt = "n", col = "dodgerblue", ylab = expression("Rain (mm)")))
with(clim.Argentina, lines(y = Rain, x = c(1:12), col = "darkorange"))
with(clim.BritishColumbia, lines(y = Rain, x = c(1:12), col = "darkgreen"))
with(clim.NorthCarolina, lines(y = Rain, x = c(1:12), col = "purple"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
legend("topright", legend = c("Western OR","Argentina","British Columbia","North Carolina"), lwd = 1, lty = 1, col = c("dodgerblue","darkorange","darkgreen","purple"))
data("cfg.Pseudotsuga.menziesii")
data("cfg.Pinus.ponderosa")
data("cfg.Eucalyptus.globulus")
data("cfg.Picea.sitchensis")
data("cfg.Pinus.contorta")
data("cfg.Pinus.radiata")
data("cfg.Pinus.taeda")
par(mar = c(5, 4, 1, 2) + 0.1)
# What parameters are different between Douglas fir and Ponderosa pine.
parameters <- names(unlist(cfg.Pseudotsuga.menziesii))
spp_parameters <- unlist(cfg.Pseudotsuga.menziesii) != unlist(cfg.Pinus.ponderosa)
douglas.fir <- as.numeric(unlist(cfg.Pseudotsuga.menziesii)[spp_parameters])
ponderosa.pine <- as.numeric(unlist(cfg.Pinus.ponderosa)[spp_parameters])
paramlabs <- names(unlist(cfg.Pinus.ponderosa)[spp_parameters])
paramlabs <- unlist(lapply(X = strsplit(split = "\\.", paramlabs), FUN = function(x){x[2]}))
plot(log(douglas.fir) ~ c(1:length(douglas.fir)), xaxt = "n", ylab = "log(parameter value)", xlab = "", pch = 21, bg = "dodgerblue", cex = 1)
points(y = log(ponderosa.pine),x = c(1:length(ponderosa.pine)), xaxt = "n", ylab = "", xlab = "", pch = 21, bg = "darkorange", cex = 1)
axis(side = 1, at = c(1:length(ponderosa.pine)), labels = paramlabs, las = 2)
legend("topleft", pch = 21,
legend = c("Douglas fir","Ponderosa pine"),
pt.bg = c("dodgerblue","darkorange"))
cfg.Pinus.ponderosa$TimeRange
cfg.Pinus.ponderosa$TimeRange$EndAge <- 25
cfg.Pinus.ponderosa$TimeRange$EndYear <- 1975
cfg.Pseudotsuga.menziesii$TimeRange$EndAge <- 25
cfg.Pseudotsuga.menziesii$TimeRange$EndYear <- 1975
doug.OR <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.WesternOR, output = FALSE, python_indexing = FALSE)
doug.AR <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.Argentina, output = FALSE, python_indexing = FALSE)
doug.BC <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.BritishColumbia, output = FALSE, python_indexing = FALSE)
doug.NC <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.NorthCarolina, output = FALSE, python_indexing = FALSE)
pipo.OR <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.WesternOR, output = FALSE, python_indexing = FALSE)
pipo.AR <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.Argentina, output = FALSE, python_indexing = FALSE)
pipo.BC <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.BritishColumbia, output = FALSE, python_indexing = FALSE)
pipo.NC <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.NorthCarolina, output = FALSE, python_indexing = FALSE)
# Convert from D13C of cellulose to wood
doug.OR$D13CTissue <- doug.OR$D13CTissue + 1.5
doug.AR$D13CTissue <- doug.AR$D13CTissue + 1.5
doug.BC$D13CTissue <- doug.BC$D13CTissue + 1.5
doug.NC$D13CTissue <- doug.NC$D13CTissue + 1.5
pipo.OR$D13CTissue <- pipo.OR$D13CTissue + 1.5
pipo.AR$D13CTissue <- pipo.AR$D13CTissue + 1.5
pipo.BC$D13CTissue <- pipo.BC$D13CTissue + 1.5
pipo.NC$D13CTissue <- pipo.NC$D13CTissue + 1.5
hist(doug.OR$NPP)
hist(doug.OR$NPP, 100)
hist(doug.OR$NPP, 100, xlim = c(0,0.5))
hist(doug.OR$NPP, 100)
cfg.Pseudotsuga.menziesii$SiteCharacteristics
doug.OR <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.WesternOR, output = FALSE, python_indexing = FALSE)
doug.BC <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.BritishColumbia, output = FALSE, python_indexing = FALSE)
doug.NC <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.NorthCarolina, output = FALSE, python_indexing = FALSE)
cfg.Pseudotsuga.menziesii$SiteCharacteristics$lat <- -40
doug.AR <- run_3pg(config = cfg.Pseudotsuga.menziesii,
climate = clim.Argentina, output = FALSE, python_indexing = FALSE)
pipo.OR <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.WesternOR, output = FALSE, python_indexing = FALSE)
pipo.BC <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.BritishColumbia, output = FALSE, python_indexing = FALSE)
pipo.NC <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.NorthCarolina, output = FALSE, python_indexing = FALSE)
cfg.Pseudotsuga.menziesii$cfg.Pinus.ponderosa$lat <- -40
pipo.AR <- run_3pg(config = cfg.Pinus.ponderosa,
climate = clim.Argentina, output = FALSE, python_indexing = FALSE)
# Convert from D13C of cellulose to wood
doug.OR$D13CTissue <- doug.OR$D13CTissue + 1.5
doug.AR$D13CTissue <- doug.AR$D13CTissue + 1.5
doug.BC$D13CTissue <- doug.BC$D13CTissue + 1.5
doug.NC$D13CTissue <- doug.NC$D13CTissue + 1.5
pipo.OR$D13CTissue <- pipo.OR$D13CTissue + 1.5
pipo.AR$D13CTissue <- pipo.AR$D13CTissue + 1.5
pipo.BC$D13CTissue <- pipo.BC$D13CTissue + 1.5
pipo.NC$D13CTissue <- pipo.NC$D13CTissue + 1.5
# Threshold
npp.threshold <- 0.05
doug.OR[doug.OR$NPP < npp.threshold,] <- NA
doug.AR[doug.AR$NPP < npp.threshold,] <- NA
doug.BC[doug.BC$NPP < npp.threshold,] <- NA
doug.NC[doug.NC$NPP < npp.threshold,] <- NA
pipo.OR[pipo.OR$NPP < npp.threshold,] <- NA
pipo.AR[pipo.AR$NPP < npp.threshold,] <- NA
pipo.BC[pipo.BC$NPP < npp.threshold,] <- NA
pipo.NC[pipo.NC$NPP < npp.threshold,] <- NA
par(mfrow = c(2,2), mar = c(2.5,4,3,1))
with(tail(doug.OR, 12), plot(D13CTissue ~ c(1:12), ylim = c(-32, -20), type = "l", xlab = "", main = "Western OR", xaxt = "n", col = "dodgerblue", ylab = expression(Wood ~{delta}^13*C~'\211')))
with(tail(pipo.OR, 12), lines(y = D13CTissue, x = c(1:12), col = "darkorange"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(tail(doug.AR, 12), plot(D13CTissue ~ c(1:12), ylim = c(-32, -20), type = "l", xlab = "", main = "Argentina", xaxt = "n", col = "dodgerblue", ylab = expression(Wood ~{delta}^13*C~'\211')))
with(tail(pipo.AR, 12), lines(y = D13CTissue, x = c(1:12), col = "darkorange"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(tail(doug.BC, 12), plot(D13CTissue ~ c(1:12), ylim = c(-32, -20), type = "l", xlab = "", main = "British Columbia", xaxt = "n", col = "dodgerblue", ylab = expression(Wood ~{delta}^13*C~'\211')))
with(tail(pipo.BC, 12), lines(y = D13CTissue, x = c(1:12), col = "darkorange"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
with(tail(doug.NC, 12), plot(D13CTissue ~ c(1:12), ylim = c(-32, -20), type = "l", xlab = "", main = "North Carolina", xaxt = "n", col = "dodgerblue", ylab = expression(Wood ~{delta}^13*C~'\211')))
with(tail(pipo.NC, 12), lines(y = D13CTissue, x = c(1:12), col = "darkorange"))
axis(side = 1, at = c(1:12), labels = month.abb, las = 2)
legend("topright", legend = c("Douglas fir","Ponderosa pine"), lwd = 1, lty = 1, col = c("dodgerblue","darkorange"))
